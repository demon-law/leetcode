# 547. çœä»½æ•°é‡

---

é¢˜ç›®æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰[https://leetcode-cn.com/problems/number-of-provinces/](https://leetcode-cn.com/problems/number-of-provinces/)

## é¢˜ç›®

---

æœ‰ `n` ä¸ªåŸå¸‚ï¼Œå…¶ä¸­ä¸€äº›å½¼æ­¤ç›¸è¿ï¼Œå¦ä¸€äº›æ²¡æœ‰ç›¸è¿ã€‚å¦‚æœåŸå¸‚ `a` ä¸åŸå¸‚ `b` ç›´æ¥ç›¸è¿ï¼Œä¸”åŸå¸‚ `b` ä¸åŸå¸‚ `c` ç›´æ¥ç›¸è¿ï¼Œé‚£ä¹ˆåŸå¸‚ `a` ä¸åŸå¸‚ `c` é—´æ¥ç›¸è¿ã€‚

**çœä»½** æ˜¯ä¸€ç»„ç›´æ¥æˆ–é—´æ¥ç›¸è¿çš„åŸå¸‚ï¼Œç»„å†…ä¸å«å…¶ä»–æ²¡æœ‰ç›¸è¿çš„åŸå¸‚ã€‚

ç»™ä½ ä¸€ä¸ª `n x n` çš„çŸ©é˜µ `isConnected` ï¼Œå…¶ä¸­ `isConnected[i][j] = 1` è¡¨ç¤ºç¬¬ `i` ä¸ªåŸå¸‚å’Œç¬¬ `j` ä¸ªåŸå¸‚ç›´æ¥ç›¸è¿ï¼Œè€Œ `isConnected[i][j] = 0` è¡¨ç¤ºäºŒè€…ä¸ç›´æ¥ç›¸è¿ã€‚

è¿”å›çŸ©é˜µä¸­ **çœä»½** çš„æ•°é‡ã€‚

 

**ç¤ºä¾‹ 1ï¼š**

![img](https://assets.leetcode.com/uploads/2020/12/24/graph1.jpg)

```
è¾“å…¥ï¼šisConnected = [[1,1,0],[1,1,0],[0,0,1]]
è¾“å‡ºï¼š2
```

**ç¤ºä¾‹ 2ï¼š**

![img](https://assets.leetcode.com/uploads/2020/12/24/graph2.jpg)

```
è¾“å…¥ï¼šisConnected = [[1,0,0],[0,1,0],[0,0,1]]
è¾“å‡ºï¼š3
```

 

**æç¤ºï¼š**

- `1 <= n <= 200`
- `n == isConnected.length`
- `n == isConnected[i].length`
- `isConnected[i][j]` ä¸º `1` æˆ– `0`
- `isConnected[i][i] == 1`
- `isConnected[i][j] == isConnected[j][i]`

## è§£é¢˜æ€è·¯

---

### æ€è·¯ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ã€å¹¿åº¦ä¼˜å…ˆæœç´¢ã€å¹¶æŸ¥é›†

å…ˆå®¡é¢˜ï¼Œé¢˜ç›®ä¸­ç»™å®š $n$ ä¸ªåŸå¸‚ï¼Œä¸€äº›å½¼æ­¤ç›¸è¿ï¼Œä¸€äº›æ²¡æœ‰ç›¸è¿ã€‚å…¶ä¸­æœ‰ä¸ª **çœä»½** çš„æ¦‚å¿µï¼Œç”±ä¸€ç»„ç›´æ¥æˆ–é—´æ¥ç›¸è¿çš„åŸå¸‚ç»„æˆï¼Œç»„å†…ä¸å­˜åœ¨å…¶ä»–æ²¡æœ‰ç›¸è¿çš„åŸå¸‚ã€‚ç°åœ¨é¢˜ç›®è¦æ±‚ï¼Œ**çœä»½** çš„æ•°é‡ï¼Ÿ

åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥å°†åŸå¸‚ä¹‹é—´çš„ç›¸è¿å…³ç³»çœ‹æˆæ˜¯å›¾ï¼ŒçŸ©é˜µ $isConnected$ æ˜¯å›¾çš„é‚»æ¥çŸ©é˜µï¼ŒåŸå¸‚æ˜¯å›¾çš„èŠ‚ç‚¹ï¼Œç›¸è¿å…³ç³»æ˜¯å›¾ä¸­ç›¸è¿çš„è¾¹ï¼Œè€Œè¦æ±‚çš„çœä»½å³æ˜¯å›¾ä¸­çš„è¿é€šåˆ†é‡ï¼Œé‚£ä¹ˆé—®é¢˜å°±å˜æˆæ±‚å›¾ä¸­è¿é€šåˆ†é‡çš„æ•°é‡ã€‚

é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢ã€å¹¿åº¦ä¼˜å…ˆæœç´¢ã€å¹¶æŸ¥é›†ã€‚

#### æ·±åº¦ä¼˜å…ˆæœç´¢

å…ˆè¯´ä¸‹æ·±åº¦ä¼˜å…ˆæœç´¢çš„åšæ³•ï¼š

- å…ˆå£°æ˜å˜é‡ $visited$ ç”¨ä»¥æ ‡è®°åŸå¸‚æ˜¯å¦è¢«éå†è®¿é—®è¿‡ï¼›
- éå†æ‰€æœ‰çš„åŸå¸‚ï¼Œè‹¥éå†çš„åŸå¸‚æœªè¢«è®¿é—®ï¼Œé‚£ä¹ˆä»¥æ­¤å¼€å§‹æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ŒåŒæ—¶è¿›è¡Œæ ‡è®°ï¼Œç›´åˆ°åŒä¸€ä¸ªè¿é€šåˆ†é‡ä¸­çš„ç‚¹éƒ½è¢«è®¿é—®ï¼Œé‚£è¡¨ç¤ºå­˜åœ¨ä¸€ä¸ªçœä»½ã€‚
- è‹¥æ­¤æ—¶è¿˜æœ‰å…¶ä»–åŸå¸‚æœªè¢«è®¿é—®ï¼Œé‚£ä¹ˆè¡¨ç¤ºæœ‰æ–°çš„è¿é€šåˆ†é‡ï¼Œç”¨ $count$ å­˜å‚¨ã€‚ç»§ç»­æœç´¢ï¼Œç›´åˆ°æ‰€æœ‰çš„åŸå¸‚éƒ½è¢«è®¿é—®ã€‚æœ€ç»ˆè¿”å› $count$ã€‚

å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹ã€‚

```python
class Solution:
    def findCircleNum(self, isConnected: List[List[int]]) -> int:
        def dfs(i):
            """ä»¥ i ä¸ºèµ·ç‚¹å¼€å§‹æ·±åº¦ä¼˜å…ˆæœç´¢
            """
            # å…ˆè¿›è¡Œæ ‡è®°
            visited[i] = 1
            # ç»§ç»­æœç´¢ä¸ i ç›¸è¿çš„åŸå¸‚
            for j in range(n):
                if isConnected[i][j] == 1 and not visited[j]:
                    dfs(j)


        # åŸå¸‚æ•°é‡
        n = len(isConnected)
        # visited ç”¨ä»¥æ ‡è®°åŸå¸‚æ˜¯å¦è¢«è®¿é—®
        visited = [0] * n
        # ç”¨ä»¥å­˜å‚¨çœä»½çš„æ•°é‡
        count = 0
        # å¼€å§‹éå†åŸå¸‚è¿›è¡Œæœç´¢
        for i in range(n):
            # åŸå¸‚æœªè¢«è®¿é—®æ—¶ï¼Œå¼€å§‹æœç´¢
            if not visited[i]:
                count += 1
                dfs(i)
        
        return count
            
```

#### å¹¿åº¦ä¼˜å…ˆæœç´¢

å¹¿åº¦ä¼˜å…ˆæœç´¢çš„æ€è·¯ï¼Œä¸ä¸Šé¢æ·±åº¦ä¼˜å…ˆæœç´¢çš„æ€è·¯ç±»ä¼¼ã€‚ç”¨ $visited$ æ ‡è®°åŸå¸‚æ˜¯å¦æ›¾è¢«è®¿é—®ï¼Œéå†åŸå¸‚ï¼Œè‹¥åŸå¸‚æœªè¢«è®¿é—®ï¼Œé‚£ä¹ˆå°±ç”±è¯¥åŸå¸‚å¼€å§‹è¿›è¡Œå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ŒçŸ¥é“åŒä¸€åˆ†é‡çš„æ‰€æœ‰åŸå¸‚éƒ½è¢«è®¿é—®ï¼Œå¯å¾—åˆ°ä¸€ä¸ªçœä»½çš„æ•°é‡ï¼Œç”¨ $count$ å­˜å‚¨ã€‚ç›´åˆ°æ‰€æœ‰çš„åŸå¸‚éƒ½è¢«è®¿é—®ï¼Œå¯å¾—çœä»½çš„æ€»æ•°ï¼Œè¿”å› $count$ã€‚

å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹ã€‚

```python
class Solution:
    def findCircleNum(self, isConnected: List[List[int]]) -> int:
        n = len(isConnected)
        # æ ‡è®°
        visited = [0] * n

        count = 0
        queue = collections.deque()

        # éå†åŸå¸‚ï¼Œå¼€å§‹æœç´¢
        for i in range(n):
            if not visited[i]:
                # æ›´æ–°å˜é‡
                visited[i] = 1
                count += 1
                queue.append(i)

                while queue:
                    # å‡ºé˜Ÿå¼€å§‹æœç´¢
                    u = queue.popleft()
                    # æœç´¢ä¸ u ç›¸è¿ä¸”æœªè¢«è®¿é—®çš„åŸå¸‚
                    for v in range(n):
                        if isConnected[u][v] == 1 and not visited[v]:
                            visited[v] = 1
                            queue.append(v)
            
        return count
```

#### å¹¶æŸ¥é›†

ç°åœ¨é—®é¢˜å˜æˆæ±‚å›¾ä¸­è¿é€šåˆ†é‡çš„æ•°é‡ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¹¶æŸ¥é›†çš„æ–¹æ³•ã€‚

$n$ ä¸ªåŸå¸‚è¡¨ç¤ºå›¾çš„ $n$ ä¸ªç‚¹ï¼Œåˆå§‹æ—¶ï¼Œä»¤æ‰€æœ‰çš„ç‚¹éƒ½æŒ‡å‘è‡ªèº«ï¼Œè‡ªæˆä¸€ä¸ªè¿é€šåˆ†é‡ã€‚

éå†çŸ©é˜µ $isConnected$ï¼Œå¦‚æœç‚¹ä¸ç‚¹ä¹‹é—´å­˜åœ¨ç›¸è¿çš„å…³ç³»ï¼Œé‚£ä¹ˆå®ƒä»¬å±äºåŒä¸€ä¸ªè¿é€šåˆ†é‡ï¼Œå°†ç‚¹ä¸å…¶é‚»æ¥ç‚¹è¿›è¡Œåˆå¹¶ã€‚

å½“æ‰€æœ‰ç‚¹éƒ½éå†åï¼Œè®¡ç®—åˆå¹¶åè¿é€šåˆ†é‡çš„æ€»æ•°ï¼Œè¿”å›ã€‚

å…·ä½“çš„ä»£ç å®ç°å¦‚ä¸‹ã€‚

```python
class UnionFind:
    """å¹¶æŸ¥é›†
    """
    def __init__(self, n):
        self.parent = [i for i in range(n)]
        # åˆå§‹è¿é€šåˆ†é‡æ•°ä¸º n ä¸ª
        self.count = n
    
    def find(self, x):
        if x != self.parent[x]:
            self.parent[x] = self.find(self.parent[x])
        return self.parent[x]
    
    def union(self, u, v):
        u_root = self.find(u)
        v_root = self.find(v)
        # åˆå¹¶ï¼Œè¿é€šåˆ†é‡æ•°å‡å°‘
        if u_root != v_root:
            self.parent[u_root] = v_root
            self.count -= 1

class Solution:
    def findCircleNum(self, isConnected: List[List[int]]) -> int:
        n = len(isConnected)
        uf = UnionFind(n)
        for i in range(n):
            for j in range(i+1, n):
                if isConnected[i][j] == 1:
                    # æœ‰ç›¸è¿å…³ç³»ï¼Œåˆ™è¿›è¡Œåˆå¹¶
                    uf.union(i, j)
        return uf.count
```

## æ¬¢è¿å…³æ³¨

---

å…¬ä¼—å· ã€[ä¹¦æ‰€é›†å½•](https://i.loli.net/2020/07/09/sNEGeV8g6fmW5Ub.jpg)ã€‘

---

**å¦‚æœ‰é”™è¯¯ï¼Œçƒ¦è¯·æŒ‡æ­£ï¼Œæ¬¢è¿æŒ‡ç‚¹äº¤æµã€‚è‹¥è§‰å¾—å†™å¾—è¿˜ä¸é”™ï¼Œéº»çƒ¦ç‚¹ä¸ªèµğŸ‘ï¼Œè°¢è°¢ã€‚**